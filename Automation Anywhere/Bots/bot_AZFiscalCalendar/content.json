{"triggers":[],"nodes":[{"uid":"24e3f5c1-4752-4498-9d07-05b5ca75d8a6","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"This bot will receive a date and return a fiscal calendar data \nwith the following format (FY:FP:FW:FQ)\n"}}]},{"uid":"df4d06f0-58d2-41c7-9e22-ae8420a515a2","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Change paramenter date to string\n"}}]},{"uid":"feb9cd57-b81c-4240-8496-02b0978ade24","commandName":"toString","packageName":"Datetime","disabled":false,"attributes":[{"name":"source","value":{"type":"VARIABLE","variableName":"dtInputDate"}},{"name":"selectPattern","value":{"type":"STRING","string":"PREBUILT"}},{"name":"preBuiltPattern","value":{"type":"STRING","string":"ISO_LOCAL_DATE"}}],"returnTo":{"type":"VARIABLE","variableName":"strDate"}},{"uid":"00043d49-1efb-4350-9f09-960b50318c6f","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Open VBScript running a script manually inserted in the step\n"}}]},{"uid":"01b99a07-10b9-4be5-a8ec-689979df5998","commandName":"vbscript.commands.openScript","packageName":"VBScript","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"vbDefault"}},{"name":"scriptOption","value":{"type":"STRING","string":"SCRIPT"}},{"name":"script","value":{"type":"STRING","string":"Function AzFiscalCalendar(dFecha)\n'This function returns fiscal calendar dates based on an input date. fiscal data FY:FP:FW:FQ\n' User needs to send a date value in order to be calculated\n\n'|-----------------------------------|\n'Define Variables\n'|-----------------------------------|\n    Dim dBegNY 'As Date\n    Dim dBegFY 'As Date\n    Dim nDays 'As Integer\n    Dim nWeekDate ' As Integer\n    Dim nWeekYear 'As Integer\n    Dim nPe 'As Integer\n    Dim FweeK 'As Integer\n    Dim nFY 'As Integer\n    Dim arr(3) 'As String\n    Dim QRT 'As Integer\n    Dim QRT2 'As Integer\n    'Dim dFecha 'as date\n    \n'|-----------------------------------|\n\n'|*** Process input date into AZ Fiscal Calendar ***|\n'|--------------------------------------------------|\n    dFecha = CDate(dFecha)\n    dBegNY = \"1/1/\" & Year(dFecha)\n    dBegNY = CDate(dBegNY)\n    dBegFY = \"9/ 1/\" & Year(dFecha)\n    dBegFY = CDate(dBegFY)\n    dBegNY = DateAdd(\"d\", -(Weekday(dBegNY)), bBegNY)\n    dBegNY = DateAdd(\"d\", 1, dBegNY)\n    dBegFY = DateAdd(\"d\", -(Weekday(dBegFY)), dBegFY)\n    dBegFY = DateAdd(\"d\", 1, dBegFY)\n    nDays = DateDiff(\"d\", dFecha, dBegNY)\n    nWeekDate = Int(nDays / 7)\n\n    nDays = dBegFY - dBegNY\n    nWeekYear = Int(nDays / 7)\n   \n    If (nWeekDate = nWeekYear) Then\n        ' [ First week of the Fiscal Year ]\n        FweeK = 1\n        nFY = Year(dFecha) + 1\n        nPe = 1\n\n    Else\n        ' [ Not the first week of the Fiscal Year ]\n\n        'dBegFY = \"9/1/\" & (Year(dFecha) - IIf(dFecha > dBegFY, 0, 1))\n\t\tIf dFecha > dBegFY then \n\t\t\tpYear = 0 \n\t\tElse\n\t\t\tpYear = 1\n\t\tEnd If\n\t\tdBegFY = \"9/1/\" & (Year(dFecha) - pYear)\n        dBegFY = DateAdd(\"d\", -(Weekday(dBegFY)), dBegFY)\n        dBegFY = DateAdd(\"d\", 1, dBegFY)\n        nDays = dFecha - dBegFY\n        nPe = Int(nDays / 28) + 1\n        FweeK = Int(nDays / 7) + 1\n        'nPe = IIf(nPe < 13, nPe, 13)\n\t\tif nPe >= 13 then nPe = 13\n        nFY = Year(dBegFY) + 1\n\n    End If\n\n    arr(0) = nFY ' Fiscal Year\n    arr(1) = nPe ' Fiscal Period\n    arr(2) = FweeK ' Fiscal Week\n'|--------------------------------------------------|\n'|--------------------------------------------------|\n\n\n\n'|--------------------------------------------------|\n'|   *** Calculate Fiscal Quarter ***\n'|--------------------------------------------------|\n 'MsgBox nPe\n    nPe = CInt(nPe)\n    If nPe >= 1 And nPe <= 3 Then\n        QRT2 = 1\n    ElseIf nPe >= 4 And nPe <= 6 Then\n        QTR2 = 2\n    ElseIf nPe >= 7 And nPe <= 9 Then\n        QTR2 = 3\n    ElseIf nPe >= 10 And nPe <= 13 Then\n        QTR2 = 4\n    End If\n        \n            \n'|--------------------------------------------------|\n'|   *** Return values  ***\n'|--------------------------------------------------|\n    \n  AzFiscalCalendar = nFY & \":\" & nPe & \":\" & FweeK & \":\" & QTR2  'return fiscal data FY:FP:FW:FQ\n  'MsgBox AzFiscalCalendar\n  'Return arr\n    'FiscalDate = arr\nEnd Function"}}]},{"uid":"39d9c50b-dea5-417e-bc0a-1e4b510ef4dd","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Run the VBScript function with Parameters"}}]},{"uid":"85ac79a9-70ee-49cd-8b8f-a71ee97bd51e","commandName":"vbscript.commands.executeFunction","packageName":"VBScript","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"vbDefault"}},{"name":"functionName","value":{"type":"STRING","string":"AzFiscalCalendar"}},{"name":"arguments","value":{"type":"VARIABLE","variableName":"strDate"}}],"returnTo":{"type":"VARIABLE","variableName":"strFiscalDate"}},{"uid":"7753cc1e-f060-4036-b0bd-09dde4f1e21b","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Close the VBScript session"}}]},{"uid":"e2521d8e-861d-401a-9334-50d12934f72e","commandName":"vbscript.commands.closeScript","packageName":"VBScript","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"vbDefault"}}]},{"uid":"9e690473-3536-410c-8d89-6595dbbcce1f","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Format strings to extract"}}]},{"uid":"14b0ce68-3593-43e1-921d-e15f0f8980bc","commandName":"beforeAfter","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$strFiscalDate$"}},{"name":"getCharacters","value":{"type":"STRING","string":"AFTER"}},{"name":"afterString","value":{"type":"STRING","string":":"}},{"name":"afterOccurrence","value":{"type":"NUMBER","number":"1"}},{"name":"ifNoMatchFound","value":{"type":"STRING","string":"EMPTY"}},{"name":"noOfCharsToGet","value":{"type":"STRING","string":"ALL"}},{"name":"trimSpaces","value":{"type":"BOOLEAN","boolean":true}},{"name":"removeEnter","value":{"type":"BOOLEAN","boolean":true}}],"returnTo":{"type":"VARIABLE","variableName":"strFY"}},{"uid":"27aea18b-ef54-443d-a46b-a5092f41bd5b","commandName":"beforeAfter","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$strFiscalDate$"}},{"name":"getCharacters","value":{"type":"STRING","string":"BEFOREAFTER"}},{"name":"beforeStringInBeforeAfter","value":{"type":"STRING","string":":"}},{"name":"beforeOccurrenceInBeforeAfter","value":{"type":"NUMBER","number":"1"}},{"name":"beforeAfterCondition","value":{"type":"STRING","string":"AND"}},{"name":"afterStringInBeforeAfter","value":{"type":"STRING","string":":"}},{"name":"afterOccurrenceInBeforeAfter","value":{"type":"NUMBER","number":"1"}},{"name":"ifNoMatchFound","value":{"type":"STRING","string":"EMPTY"}},{"name":"noOfCharsToGet","value":{"type":"STRING","string":"ALL"}},{"name":"trimSpaces","value":{"type":"BOOLEAN","boolean":true}},{"name":"removeEnter","value":{"type":"BOOLEAN","boolean":true}}],"returnTo":{"type":"VARIABLE","variableName":"strFP"}},{"uid":"449e98e7-9df4-4f10-9db7-793a95f187ea","commandName":"beforeAfter","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$strFiscalDate$"}},{"name":"getCharacters","value":{"type":"STRING","string":"BEFOREAFTER"}},{"name":"beforeStringInBeforeAfter","value":{"type":"STRING","string":":"}},{"name":"beforeOccurrenceInBeforeAfter","value":{"type":"NUMBER","number":"2"}},{"name":"beforeAfterCondition","value":{"type":"STRING","string":"AND"}},{"name":"afterStringInBeforeAfter","value":{"type":"STRING","string":":"}},{"name":"afterOccurrenceInBeforeAfter","value":{"type":"NUMBER","number":"1"}},{"name":"ifNoMatchFound","value":{"type":"STRING","string":"EMPTY"}},{"name":"noOfCharsToGet","value":{"type":"STRING","string":"ALL"}},{"name":"trimSpaces","value":{"type":"BOOLEAN","boolean":true}},{"name":"removeEnter","value":{"type":"BOOLEAN","boolean":true}}],"returnTo":{"type":"VARIABLE","variableName":"strFW"}},{"uid":"5cc2fb33-9c1b-432c-a33f-048b2ff27d30","commandName":"beforeAfter","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$strFiscalDate$"}},{"name":"getCharacters","value":{"type":"STRING","string":"BEFORE"}},{"name":"beforeString","value":{"type":"STRING","string":":"}},{"name":"beforeOccurrence","value":{"type":"NUMBER","number":"3"}},{"name":"ifNoMatchFound","value":{"type":"STRING","string":"EMPTY"}},{"name":"noOfCharsToGet","value":{"type":"STRING","string":"ALL"}},{"name":"trimSpaces","value":{"type":"BOOLEAN","boolean":true}},{"name":"removeEnter","value":{"type":"BOOLEAN","boolean":true}}],"returnTo":{"type":"VARIABLE","variableName":"strFQ"}}],"variables":[{"type":"NUMBER","subtype":"UNDEFINED","readOnly":false,"input":false,"output":false,"name":"SampleNumber"},{"type":"STRING","subtype":"UNDEFINED","readOnly":false,"input":false,"output":false,"name":"SampleString"},{"name":"dtInputDate","description":"","type":"DATETIME","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"DATETIME","string":""}},{"name":"strFiscalDate","description":"","type":"STRING","readOnly":false,"input":false,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"strDate","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"strFY","description":"","type":"STRING","readOnly":false,"input":false,"output":true,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"strFP","description":"","type":"STRING","readOnly":false,"input":false,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"strFW","description":"","type":"STRING","readOnly":false,"input":false,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"strFQ","description":"","type":"STRING","readOnly":false,"input":false,"output":true,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}}],"breakpoints":[],"packages":[{"name":"Comment","version":"2.10.0-20220118-153626"},{"name":"Datetime","version":"2.7.0-20220118-153714"},{"name":"String","version":"5.3.0-20220118-134628"},{"name":"VBScript","version":"2.13.1-20220207-165826"}],"migrationJournalReviewIds":[],"workItemTemplateName":null,"properties":{"botCodeVersion":"2","improvedNumberSupport":true,"timeout":"0s","automationPriority":"PRIORITY_MEDIUM"}}